<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AJA NTV2 SDK: The KONA XM™ Supplement</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
<link href="../../ajastyles.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="../../AJALogoMini.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AJA NTV2 SDK
   &#160;<span id="projectnumber">17.5.0.1353</span>
   </div>
   <div id="projectbrief">NTV2 SDK 17.5.0.1353</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d7/dfa/xmsupplement.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">The KONA XM™ Supplement </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="xmoverview"></a>
Overview</h1>
<p>This document discusses special considerations when working with the <a class="el" href="../../d0/d53/ntv2devices.html#konaxm">KONA XM™</a> device when flashed with the special “XM” firmware that supports multiple, continuous asynchronous DMA transfers.</p>
<p>As of SDK 17.5, only the Linux NTV2 kernel driver supports CNTV2Card’s streaming DMA APIs.</p>
<p>The SDK provides two demonstration programs that utilize the streaming DMA APIs:</p><ul>
<li><a class="el" href="../../d9/d07/demoapps.html#ntv2streamplayer">NTV2StreamPlayer Demo</a> — a simple video-only player;</li>
<li>ntv2streampreview — a Qt-based GUI program that captures and displays incoming video.</li>
</ul>
<h1><a class="anchor" id="xmhwinstall"></a>
Installing the Hardware</h1>
<p>The <a class="el" href="../../d0/d53/ntv2devices.html#konaxm">KONA XM™</a> must be installed in appropriate PCIe slots. The minimum requirements are a PCI Express Gen3 × 4 lane slot.</p>
<p>It is necessary to supply external power to the <a class="el" href="../../d0/d53/ntv2devices.html#konaxm">KONA XM™</a> using the ATX 6-Pin connector located on the back of the card.</p>
<h2><a class="anchor" id="xmfirmware"></a>
Obtaining &amp; Installing KONA XM Firmware</h2>
<p>…where to get the XM firmware…</p>
<p>…how to install the XM firmware…</p>
<h2><a class="anchor" id="xmtesting"></a>
Testing KONA XM</h2>
<p>…describe how to run streamplayer</p>
<p>See <a class="el" href="../../d9/d07/demoapps.html#ntv2encodehevc">NTV2EncodeHEVC Demo</a> for more information.</p>
<h1><a class="anchor" id="xmimplementation"></a>
Streaming APIs</h1>
<p>This section explores the HEVC specific APIs of the SDK. AJA borrowed extensively from the MB86M31-Evaluation Board SDK, but rather than copy directly, AJA implemented its own APIs which are much closer aligned with how the NTV2 SDK works. The MB86M31 encoder implementation is an extension of the current NTV2 APIs, with its own classes to initialize, configure, control, and stream data to and from the encoder.</p>
<h2><a class="anchor" id="xmimpl-kernel"></a>
The Kernel Driver</h2>
<p>Five driver APIs have been added to support HEVC:</p><ul>
<li><code>bool HevcMessageGetDeviceInfo (HevcMessageInfo* pMessage);</code></li>
<li><code>bool HevcMessageSendCommand (HevcMessageCommand* pMessage);</code></li>
<li><code>bool HevcMessageVideoTransfer (HevcMessageTransfer* pMessage);</code></li>
<li><code>bool HevcMessageGetStatus (HevcMessageStatus* pMessage);</code></li>
<li><code>bool HevcMessageDebugInfo (HevcMessageDebug* pMessage);</code></li>
</ul>
<p>In addition the above HEVC specific functions, the standard NTV2 <a class="el" href="../../dc/dfc/class_c_n_t_v2_mac_driver_interface.html#a5bebfb895579a15841603f1191b37266" title="Reads all or part of the 32-bit contents of a specific register (real or virtual) on the AJA device....">CNTV2Card::ReadRegister</a> and <a class="el" href="../../dc/dfc/class_c_n_t_v2_mac_driver_interface.html#aa996046aa48e6c684fd77d7b1d99bd40" title="Updates or replaces all or part of the 32-bit contents of a specific register (real or virtual) on th...">CNTV2Card::WriteRegister</a> functions have been modified to recognize register reads and writes to the MB86M31 encoder. The PARM setup classes in <code>ajalibraries/ajantv2/codecs/hevc/m31</code> make extensive use of <a class="el" href="../../dc/dfc/class_c_n_t_v2_mac_driver_interface.html#a5bebfb895579a15841603f1191b37266" title="Reads all or part of the 32-bit contents of a specific register (real or virtual) on the AJA device....">CNTV2Card::ReadRegister</a> and <a class="el" href="../../dc/dfc/class_c_n_t_v2_mac_driver_interface.html#aa996046aa48e6c684fd77d7b1d99bd40" title="Updates or replaces all or part of the 32-bit contents of a specific register (real or virtual) on th...">CNTV2Card::WriteRegister</a> to read and write individual PARAM fields in the MB86M31 space. The interface is identical to <a class="el" href="../../dc/dfc/class_c_n_t_v2_mac_driver_interface.html#a5bebfb895579a15841603f1191b37266" title="Reads all or part of the 32-bit contents of a specific register (real or virtual) on the AJA device....">CNTV2Card::ReadRegister</a> and <a class="el" href="../../dc/dfc/class_c_n_t_v2_mac_driver_interface.html#aa996046aa48e6c684fd77d7b1d99bd40" title="Updates or replaces all or part of the 32-bit contents of a specific register (real or virtual) on th...">CNTV2Card::WriteRegister</a> in the NTV2 space.</p>
<h2><a class="anchor" id="hevcimpl-vidxfer"></a>
VideoTransfer</h2>
<p>Frames are sent to and from the encoder using the following APIs located in the M31 helper class:</p><ul>
<li><code>bool RawTransfer (uint8_t* pBuffer, uint32_t dataSize, bool lastFrame);</code></li>
<li><code>bool EncTransfer (uint8_t* pBuffer, uint32_t bufferSize, uint32_t&amp; dataSize, bool&amp; lastFrame);</code></li>
</ul>
<p>Once the encoder has started, pass uncompressed YUV planar frames into the encoder using <code>RawTransfer</code>, and when the encoder has encoded the frame, you can get them back using <code>EncTransfer</code>. See the <a class="el" href="../../d9/d07/demoapps.html#ntv2encodehevc">NTV2EncodeHEVC Demo</a> application for more details. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Fri Nov 8 2024 17:12:54 for AJA NTV2 SDK by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="../../doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
